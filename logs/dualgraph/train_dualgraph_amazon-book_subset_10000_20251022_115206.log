2025-10-22 11:52:06 - INFO - Log file: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../logs/dualgraph/train_dualgraph_amazon-book_subset_10000_20251022_115206.log
2025-10-22 11:52:06 - INFO - >>SEED: 2020
2025-10-22 11:52:07 - INFO - >>DEVICE: cuda
2025-10-22 11:52:07 - INFO - 
============================================================
2025-10-22 11:52:07 - INFO - Loading dataset: amazon-book_subset_10000
2025-10-22 11:52:07 - INFO - ============================================================
2025-10-22 11:52:10 - INFO - Dataset Statistics:
2025-10-22 11:52:10 - INFO -   - Users: 19930
2025-10-22 11:52:10 - INFO -   - Items: 10000
2025-10-22 11:52:10 - INFO -   - Train interactions: 365328
2025-10-22 11:52:10 - INFO -   - Test interactions: 65052
2025-10-22 11:52:10 - INFO - ✓ Semantic graph loaded successfully
2025-10-22 11:52:10 - INFO - 
============================================================
2025-10-22 11:52:10 - INFO - Building Dual-Graph LightGCN
2025-10-22 11:52:10 - INFO - ============================================================
2025-10-22 11:52:21 - INFO - Model parameters:
2025-10-22 11:52:21 - INFO -   - Embedding dim: 64
2025-10-22 11:52:21 - INFO -   - UI graph layers: 3
2025-10-22 11:52:21 - INFO -   - Semantic layers: 2
2025-10-22 11:52:21 - INFO -   - Semantic weight: 0.5
2025-10-22 11:52:21 - INFO -   - Learning rate: 0.001
2025-10-22 11:52:22 - INFO - 
Model checkpoint: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../checkpoints/dualgraph/dualgraph-amazon-book_subset_10000-64.pth.tar
2025-10-22 11:52:22 - INFO - Tensorboard: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../runs/10-22-11h52m22s-dual-graph-10k
2025-10-22 11:52:22 - INFO - 
============================================================
2025-10-22 11:52:22 - INFO - Training for 100 epochs
2025-10-22 11:52:22 - INFO - ============================================================

2025-10-22 11:52:22 - INFO - 
[TEST] Epoch 0
2025-10-22 11:52:26 - INFO -   Recall@[20]: [0.00173825]
2025-10-22 11:52:26 - INFO -   Precision@[20]: [0.00036428]
2025-10-22 11:52:26 - INFO -   NDCG@[20]: [0.00087721]
2025-10-22 11:52:26 - INFO - ✓ New best! Recall@20: 0.0017
2025-10-22 11:52:33 - INFO - EPOCH[1/100] loss0.689-|Sample:3.10| Time: 10.8s
2025-10-22 11:52:40 - INFO - EPOCH[2/100] loss0.643-|Sample:3.15| Time: 6.4s
2025-10-22 11:52:46 - INFO - EPOCH[3/100] loss0.514-|Sample:3.59| Time: 6.4s
2025-10-22 11:52:52 - INFO - EPOCH[4/100] loss0.423-|Sample:3.50| Time: 6.3s
2025-10-22 11:52:59 - INFO - EPOCH[5/100] loss0.362-|Sample:3.59| Time: 6.4s
2025-10-22 11:53:05 - INFO - EPOCH[6/100] loss0.322-|Sample:3.46| Time: 6.2s
2025-10-22 11:53:12 - INFO - EPOCH[7/100] loss0.293-|Sample:3.73| Time: 6.5s
2025-10-22 11:53:18 - INFO - EPOCH[8/100] loss0.274-|Sample:3.53| Time: 6.1s
2025-10-22 11:53:24 - INFO - EPOCH[9/100] loss0.255-|Sample:3.55| Time: 6.2s
2025-10-22 11:53:30 - INFO - EPOCH[10/100] loss0.243-|Sample:3.60| Time: 6.2s
2025-10-22 11:53:30 - INFO - 
[TEST] Epoch 10
2025-10-22 11:53:33 - INFO -   Recall@[20]: [0.06293043]
2025-10-22 11:53:33 - INFO -   Precision@[20]: [0.01085019]
2025-10-22 11:53:33 - INFO -   NDCG@[20]: [0.03637934]
2025-10-22 11:53:33 - INFO - ✓ New best! Recall@20: 0.0629
2025-10-22 11:53:39 - INFO - EPOCH[11/100] loss0.232-|Sample:3.33| Time: 8.5s
2025-10-22 11:53:45 - INFO - EPOCH[12/100] loss0.222-|Sample:3.68| Time: 6.5s
2025-10-22 11:53:52 - INFO - EPOCH[13/100] loss0.214-|Sample:3.59| Time: 6.4s
2025-10-22 11:53:58 - INFO - EPOCH[14/100] loss0.205-|Sample:3.46| Time: 6.3s
2025-10-22 11:54:04 - INFO - EPOCH[15/100] loss0.200-|Sample:3.46| Time: 5.5s
2025-10-22 11:54:09 - INFO - EPOCH[16/100] loss0.193-|Sample:3.58| Time: 6.0s
2025-10-22 11:54:16 - INFO - EPOCH[17/100] loss0.186-|Sample:3.54| Time: 6.3s
2025-10-22 11:54:22 - INFO - EPOCH[18/100] loss0.182-|Sample:3.56| Time: 6.3s
2025-10-22 11:54:28 - INFO - EPOCH[19/100] loss0.177-|Sample:3.53| Time: 5.8s
2025-10-22 11:54:34 - INFO - EPOCH[20/100] loss0.172-|Sample:3.45| Time: 6.2s
2025-10-22 11:54:34 - INFO - 
[TEST] Epoch 20
2025-10-22 11:54:37 - INFO -   Recall@[20]: [0.06908074]
2025-10-22 11:54:37 - INFO -   Precision@[20]: [0.0123284]
2025-10-22 11:54:37 - INFO -   NDCG@[20]: [0.04071845]
2025-10-22 11:54:37 - INFO - ✓ New best! Recall@20: 0.0691
2025-10-22 11:54:43 - INFO - EPOCH[21/100] loss0.169-|Sample:3.33| Time: 8.5s
2025-10-22 11:54:49 - INFO - EPOCH[22/100] loss0.162-|Sample:3.08| Time: 5.8s
2025-10-22 11:54:55 - INFO - EPOCH[23/100] loss0.159-|Sample:3.58| Time: 6.4s
2025-10-22 11:55:02 - INFO - EPOCH[24/100] loss0.155-|Sample:3.60| Time: 6.5s
2025-10-22 11:55:08 - INFO - EPOCH[25/100] loss0.151-|Sample:3.55| Time: 6.3s
2025-10-22 11:55:14 - INFO - EPOCH[26/100] loss0.148-|Sample:3.48| Time: 6.3s
2025-10-22 11:55:21 - INFO - EPOCH[27/100] loss0.145-|Sample:3.43| Time: 6.2s
2025-10-22 11:55:27 - INFO - EPOCH[28/100] loss0.143-|Sample:3.71| Time: 6.4s
2025-10-22 11:55:33 - INFO - EPOCH[29/100] loss0.138-|Sample:3.49| Time: 6.2s
2025-10-22 11:55:39 - INFO - EPOCH[30/100] loss0.136-|Sample:3.49| Time: 6.1s
2025-10-22 11:55:39 - INFO - 
[TEST] Epoch 30
2025-10-22 11:55:42 - INFO -   Recall@[20]: [0.07394565]
2025-10-22 11:55:42 - INFO -   Precision@[20]: [0.01331286]
2025-10-22 11:55:42 - INFO -   NDCG@[20]: [0.04346688]
2025-10-22 11:55:42 - INFO - ✓ New best! Recall@20: 0.0739
2025-10-22 11:55:49 - INFO - EPOCH[31/100] loss0.134-|Sample:3.12| Time: 9.7s
2025-10-22 11:55:57 - INFO - EPOCH[32/100] loss0.130-|Sample:3.59| Time: 7.4s
2025-10-22 11:56:04 - INFO - EPOCH[33/100] loss0.127-|Sample:3.41| Time: 6.9s
2025-10-22 11:56:10 - INFO - EPOCH[34/100] loss0.125-|Sample:3.23| Time: 6.5s
2025-10-22 11:56:17 - INFO - EPOCH[35/100] loss0.122-|Sample:3.57| Time: 6.9s
2025-10-22 11:56:23 - INFO - EPOCH[36/100] loss0.121-|Sample:3.61| Time: 6.1s
2025-10-22 11:56:30 - INFO - EPOCH[37/100] loss0.118-|Sample:3.58| Time: 6.4s
2025-10-22 11:56:37 - INFO - EPOCH[38/100] loss0.115-|Sample:3.67| Time: 7.0s
2025-10-22 11:56:44 - INFO - EPOCH[39/100] loss0.113-|Sample:3.41| Time: 7.3s
2025-10-22 11:56:51 - INFO - EPOCH[40/100] loss0.111-|Sample:3.52| Time: 7.1s
2025-10-22 11:56:51 - INFO - 
[TEST] Epoch 40
2025-10-22 11:56:53 - INFO -   Recall@[20]: [0.07767395]
2025-10-22 11:56:53 - INFO -   Precision@[20]: [0.01413475]
2025-10-22 11:56:53 - INFO -   NDCG@[20]: [0.04557873]
2025-10-22 11:56:53 - INFO - ✓ New best! Recall@20: 0.0777
2025-10-22 11:56:59 - INFO - EPOCH[41/100] loss0.109-|Sample:3.06| Time: 7.8s
2025-10-22 11:57:05 - INFO - EPOCH[42/100] loss0.107-|Sample:3.55| Time: 6.4s
2025-10-22 11:57:12 - INFO - EPOCH[43/100] loss0.105-|Sample:3.43| Time: 6.2s
2025-10-22 11:57:18 - INFO - EPOCH[44/100] loss0.103-|Sample:3.54| Time: 6.0s
2025-10-22 11:57:23 - INFO - EPOCH[45/100] loss0.100-|Sample:3.50| Time: 5.4s
2025-10-22 11:57:29 - INFO - EPOCH[46/100] loss0.100-|Sample:3.49| Time: 5.8s
2025-10-22 11:57:35 - INFO - EPOCH[47/100] loss0.099-|Sample:3.58| Time: 6.6s
2025-10-22 11:57:42 - INFO - EPOCH[48/100] loss0.096-|Sample:3.53| Time: 6.3s
2025-10-22 11:57:49 - INFO - EPOCH[49/100] loss0.094-|Sample:3.47| Time: 7.3s
2025-10-22 11:57:57 - INFO - EPOCH[50/100] loss0.093-|Sample:3.55| Time: 7.5s
2025-10-22 11:57:57 - INFO - 
[TEST] Epoch 50
2025-10-22 11:57:59 - INFO -   Recall@[20]: [0.08132859]
2025-10-22 11:57:59 - INFO -   Precision@[20]: [0.01470075]
2025-10-22 11:57:59 - INFO -   NDCG@[20]: [0.04755805]
2025-10-22 11:57:59 - INFO - ✓ New best! Recall@20: 0.0813
2025-10-22 11:58:05 - INFO - EPOCH[51/100] loss0.091-|Sample:3.49| Time: 8.7s
2025-10-22 11:58:12 - INFO - EPOCH[52/100] loss0.090-|Sample:3.43| Time: 6.2s
2025-10-22 11:58:18 - INFO - EPOCH[53/100] loss0.088-|Sample:3.44| Time: 6.3s
2025-10-22 11:58:24 - INFO - EPOCH[54/100] loss0.086-|Sample:3.58| Time: 5.8s
2025-10-22 11:58:29 - INFO - EPOCH[55/100] loss0.086-|Sample:3.44| Time: 5.3s
2025-10-22 11:58:35 - INFO - EPOCH[56/100] loss0.083-|Sample:3.55| Time: 6.1s
2025-10-22 11:58:42 - INFO - EPOCH[57/100] loss0.082-|Sample:3.42| Time: 6.2s
2025-10-22 11:58:48 - INFO - EPOCH[58/100] loss0.082-|Sample:3.63| Time: 6.5s
2025-10-22 11:58:55 - INFO - EPOCH[59/100] loss0.080-|Sample:3.42| Time: 6.5s
2025-10-22 11:59:00 - INFO - EPOCH[60/100] loss0.079-|Sample:3.41| Time: 5.8s
2025-10-22 11:59:00 - INFO - 
[TEST] Epoch 60
2025-10-22 11:59:03 - INFO -   Recall@[20]: [0.08356805]
2025-10-22 11:59:03 - INFO -   Precision@[20]: [0.01498675]
2025-10-22 11:59:03 - INFO -   NDCG@[20]: [0.04869279]
2025-10-22 11:59:03 - INFO - ✓ New best! Recall@20: 0.0836
2025-10-22 11:59:09 - INFO - EPOCH[61/100] loss0.078-|Sample:3.36| Time: 8.9s
2025-10-22 11:59:17 - INFO - EPOCH[62/100] loss0.077-|Sample:3.41| Time: 7.4s
2025-10-22 11:59:24 - INFO - EPOCH[63/100] loss0.074-|Sample:3.56| Time: 7.5s
2025-10-22 11:59:31 - INFO - EPOCH[64/100] loss0.075-|Sample:3.55| Time: 6.9s
2025-10-22 11:59:38 - INFO - EPOCH[65/100] loss0.073-|Sample:3.41| Time: 7.1s
2025-10-22 11:59:45 - INFO - EPOCH[66/100] loss0.072-|Sample:3.06| Time: 6.9s
2025-10-22 11:59:53 - INFO - EPOCH[67/100] loss0.071-|Sample:3.48| Time: 7.3s
2025-10-22 11:59:59 - INFO - EPOCH[68/100] loss0.070-|Sample:3.38| Time: 6.8s
2025-10-22 12:00:06 - INFO - EPOCH[69/100] loss0.070-|Sample:3.52| Time: 7.0s
2025-10-22 12:00:13 - INFO - EPOCH[70/100] loss0.069-|Sample:3.52| Time: 6.5s
2025-10-22 12:00:13 - INFO - 
[TEST] Epoch 70
2025-10-22 12:00:16 - INFO -   Recall@[20]: [0.08434468]
2025-10-22 12:00:16 - INFO -   Precision@[20]: [0.01509815]
2025-10-22 12:00:16 - INFO -   NDCG@[20]: [0.04936246]
2025-10-22 12:00:16 - INFO - ✓ New best! Recall@20: 0.0843
2025-10-22 12:00:22 - INFO - EPOCH[71/100] loss0.068-|Sample:3.21| Time: 9.2s
2025-10-22 12:00:29 - INFO - EPOCH[72/100] loss0.066-|Sample:3.07| Time: 6.5s
2025-10-22 12:00:36 - INFO - EPOCH[73/100] loss0.067-|Sample:3.59| Time: 6.8s
2025-10-22 12:00:42 - INFO - EPOCH[74/100] loss0.066-|Sample:3.43| Time: 6.1s
2025-10-22 12:00:48 - INFO - EPOCH[75/100] loss0.065-|Sample:3.42| Time: 6.6s
2025-10-22 12:00:55 - INFO - EPOCH[76/100] loss0.064-|Sample:3.48| Time: 6.5s
2025-10-22 12:01:01 - INFO - EPOCH[77/100] loss0.064-|Sample:3.54| Time: 6.5s
2025-10-22 12:01:09 - INFO - EPOCH[78/100] loss0.062-|Sample:3.48| Time: 7.4s
2025-10-22 12:01:16 - INFO - EPOCH[79/100] loss0.061-|Sample:3.54| Time: 7.2s
2025-10-22 12:01:23 - INFO - EPOCH[80/100] loss0.061-|Sample:3.43| Time: 6.9s
2025-10-22 12:01:23 - INFO - 
[TEST] Epoch 80
2025-10-22 12:01:25 - INFO -   Recall@[20]: [0.08612186]
2025-10-22 12:01:25 - INFO -   Precision@[20]: [0.01549253]
2025-10-22 12:01:25 - INFO -   NDCG@[20]: [0.05014914]
2025-10-22 12:01:25 - INFO - ✓ New best! Recall@20: 0.0861
2025-10-22 12:01:32 - INFO - EPOCH[81/100] loss0.060-|Sample:3.50| Time: 9.2s
2025-10-22 12:01:39 - INFO - EPOCH[82/100] loss0.059-|Sample:3.51| Time: 6.9s
2025-10-22 12:01:46 - INFO - EPOCH[83/100] loss0.059-|Sample:3.58| Time: 7.3s
2025-10-22 12:01:54 - INFO - EPOCH[84/100] loss0.058-|Sample:3.41| Time: 7.3s
2025-10-22 12:02:01 - INFO - EPOCH[85/100] loss0.058-|Sample:3.59| Time: 7.5s
2025-10-22 12:02:09 - INFO - EPOCH[86/100] loss0.056-|Sample:3.38| Time: 7.3s
2025-10-22 12:02:15 - INFO - EPOCH[87/100] loss0.056-|Sample:3.39| Time: 6.7s
2025-10-22 12:02:22 - INFO - EPOCH[88/100] loss0.055-|Sample:3.54| Time: 7.0s
2025-10-22 12:02:30 - INFO - EPOCH[89/100] loss0.055-|Sample:3.52| Time: 7.2s
2025-10-22 12:02:37 - INFO - EPOCH[90/100] loss0.054-|Sample:3.45| Time: 7.4s
2025-10-22 12:02:37 - INFO - 
[TEST] Epoch 90
2025-10-22 12:02:39 - INFO -   Recall@[20]: [0.08735602]
2025-10-22 12:02:39 - INFO -   Precision@[20]: [0.01569424]
2025-10-22 12:02:39 - INFO -   NDCG@[20]: [0.05109649]
2025-10-22 12:02:39 - INFO - ✓ New best! Recall@20: 0.0874
2025-10-22 12:02:46 - INFO - EPOCH[91/100] loss0.054-|Sample:3.36| Time: 8.6s
2025-10-22 12:02:52 - INFO - EPOCH[92/100] loss0.053-|Sample:3.53| Time: 6.3s
2025-10-22 12:02:58 - INFO - EPOCH[93/100] loss0.053-|Sample:3.46| Time: 6.2s
2025-10-22 12:03:04 - INFO - EPOCH[94/100] loss0.052-|Sample:3.46| Time: 6.2s
2025-10-22 12:03:11 - INFO - EPOCH[95/100] loss0.051-|Sample:3.53| Time: 6.5s
2025-10-22 12:03:17 - INFO - EPOCH[96/100] loss0.051-|Sample:3.54| Time: 6.3s
2025-10-22 12:03:24 - INFO - EPOCH[97/100] loss0.051-|Sample:3.50| Time: 6.4s
2025-10-22 12:03:30 - INFO - EPOCH[98/100] loss0.050-|Sample:3.52| Time: 6.3s
2025-10-22 12:03:36 - INFO - EPOCH[99/100] loss0.049-|Sample:3.41| Time: 6.2s
2025-10-22 12:03:42 - INFO - EPOCH[100/100] loss0.049-|Sample:3.50| Time: 6.3s
2025-10-22 12:03:42 - INFO - 
============================================================
2025-10-22 12:03:42 - INFO - Final Evaluation
2025-10-22 12:03:42 - INFO - ============================================================
2025-10-22 12:03:45 - INFO - 
Final Results:
2025-10-22 12:03:45 - INFO -   Recall@[20]: [0.08821092]
2025-10-22 12:03:45 - INFO -   Precision@[20]: [0.01580564]
2025-10-22 12:03:45 - INFO -   NDCG@[20]: [0.05167889]
2025-10-22 12:03:45 - INFO - 
Best: Epoch 90, Recall@20: 0.0874
2025-10-22 12:03:45 - INFO - 
✓ Training completed!
2025-10-22 12:03:45 - INFO - Log saved to: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../logs/dualgraph/train_dualgraph_amazon-book_subset_10000_20251022_115206.log
