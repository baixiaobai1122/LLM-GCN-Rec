2025-10-23 13:40:05 - INFO - Log file: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../logs/dualgraph_hybrid/train_dualgraph_hybrid_amazon-book_subset_10000_20251023_134005.log
2025-10-23 13:40:05 - INFO - 
============================================================
2025-10-23 13:40:05 - INFO -  HYBRID FEATURES MODE: CLIP + GPT
2025-10-23 13:40:05 - INFO - Semantic graph file: hybrid_semantic_graph.npz
2025-10-23 13:40:05 - INFO - ============================================================

2025-10-23 13:40:05 - INFO - >>SEED: 2020
2025-10-23 13:40:06 - INFO - >>DEVICE: cuda
2025-10-23 13:40:06 - INFO - 
============================================================
2025-10-23 13:40:06 - INFO - Loading dataset: amazon-book_subset_10000
2025-10-23 13:40:06 - INFO - ============================================================
2025-10-23 13:40:09 - INFO - Dataset Statistics:
2025-10-23 13:40:09 - INFO -   - Users: 19930
2025-10-23 13:40:09 - INFO -   - Items: 10000
2025-10-23 13:40:09 - INFO -   - Train interactions: 365328
2025-10-23 13:40:09 - INFO -   - Test interactions: 65052
2025-10-23 13:40:09 - INFO - ✓ Semantic graph loaded successfully
2025-10-23 13:40:09 - INFO - 
============================================================
2025-10-23 13:40:09 - INFO - Building Dual-Graph LightGCN
2025-10-23 13:40:09 - INFO - ============================================================
2025-10-23 13:40:09 - INFO - Model parameters:
2025-10-23 13:40:09 - INFO -   - Embedding dim: 64
2025-10-23 13:40:09 - INFO -   - UI graph layers: 3
2025-10-23 13:40:09 - INFO -   - Semantic layers: 2
2025-10-23 13:40:09 - INFO -   - Semantic weight: 0.9
2025-10-23 13:40:09 - INFO -   - Learning rate: 0.001
2025-10-23 13:40:11 - INFO - 
Model checkpoint: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../checkpoints/dualgraph_hybrid/dualgraph_hybrid-amazon-book_subset_10000-64.pth.tar
2025-10-23 13:40:11 - INFO - Feature type: CLIP+GPT Hybrid
2025-10-23 13:40:11 - INFO - Tensorboard: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../runs/10-23-13h40m11s-CLIP+GPT_hybrid
2025-10-23 13:40:11 - INFO - 
============================================================
2025-10-23 13:40:11 - INFO - Training for 100 epochs
2025-10-23 13:40:11 - INFO - ============================================================

2025-10-23 13:40:11 - INFO - 
[TEST] Epoch 0
2025-10-23 13:40:13 - INFO -   Recall@[20]: [0.00185402]
2025-10-23 13:40:13 - INFO -   Precision@[20]: [0.0003974]
2025-10-23 13:40:13 - INFO -   NDCG@[20]: [0.00097609]
2025-10-23 13:40:13 - INFO - ✓ New best! Recall@20: 0.0019
2025-10-23 13:40:20 - INFO - EPOCH[1/100] loss0.690-|Sample:3.55| Time: 9.4s
2025-10-23 13:40:27 - INFO - EPOCH[2/100] loss0.668-|Sample:3.72| Time: 6.7s
2025-10-23 13:40:33 - INFO - EPOCH[3/100] loss0.575-|Sample:3.73| Time: 6.0s
2025-10-23 13:40:39 - INFO - EPOCH[4/100] loss0.459-|Sample:3.51| Time: 6.2s
2025-10-23 13:40:45 - INFO - EPOCH[5/100] loss0.380-|Sample:3.59| Time: 5.8s
2025-10-23 13:40:51 - INFO - EPOCH[6/100] loss0.329-|Sample:3.19| Time: 6.1s
2025-10-23 13:40:58 - INFO - EPOCH[7/100] loss0.295-|Sample:3.77| Time: 6.7s
2025-10-23 13:41:04 - INFO - EPOCH[8/100] loss0.272-|Sample:3.67| Time: 6.2s
2025-10-23 13:41:10 - INFO - EPOCH[9/100] loss0.253-|Sample:3.49| Time: 6.1s
2025-10-23 13:41:16 - INFO - EPOCH[10/100] loss0.239-|Sample:3.58| Time: 5.4s
2025-10-23 13:41:16 - INFO - 
[TEST] Epoch 10
2025-10-23 13:41:18 - INFO -   Recall@[20]: [0.06121226]
2025-10-23 13:41:18 - INFO -   Precision@[20]: [0.01100975]
2025-10-23 13:41:18 - INFO -   NDCG@[20]: [0.03572723]
2025-10-23 13:41:18 - INFO - ✓ New best! Recall@20: 0.0612
2025-10-23 13:41:24 - INFO - EPOCH[11/100] loss0.227-|Sample:3.52| Time: 8.2s
2025-10-23 13:41:30 - INFO - EPOCH[12/100] loss0.217-|Sample:3.51| Time: 6.2s
2025-10-23 13:41:37 - INFO - EPOCH[13/100] loss0.208-|Sample:3.64| Time: 6.4s
2025-10-23 13:41:43 - INFO - EPOCH[14/100] loss0.198-|Sample:3.51| Time: 6.2s
2025-10-23 13:41:49 - INFO - EPOCH[15/100] loss0.193-|Sample:3.70| Time: 6.3s
2025-10-23 13:41:55 - INFO - EPOCH[16/100] loss0.186-|Sample:3.55| Time: 6.1s
2025-10-23 13:42:02 - INFO - EPOCH[17/100] loss0.179-|Sample:3.53| Time: 6.2s
2025-10-23 13:42:07 - INFO - EPOCH[18/100] loss0.175-|Sample:3.59| Time: 5.4s
2025-10-23 13:42:12 - INFO - EPOCH[19/100] loss0.169-|Sample:3.12| Time: 5.1s
2025-10-23 13:42:18 - INFO - EPOCH[20/100] loss0.164-|Sample:3.23| Time: 5.8s
2025-10-23 13:42:18 - INFO - 
[TEST] Epoch 20
2025-10-23 13:42:21 - INFO -   Recall@[20]: [0.06940435]
2025-10-23 13:42:21 - INFO -   Precision@[20]: [0.0125843]
2025-10-23 13:42:21 - INFO -   NDCG@[20]: [0.04067131]
2025-10-23 13:42:21 - INFO - ✓ New best! Recall@20: 0.0694
2025-10-23 13:42:27 - INFO - EPOCH[21/100] loss0.160-|Sample:3.47| Time: 8.6s
2025-10-23 13:42:33 - INFO - EPOCH[22/100] loss0.154-|Sample:3.50| Time: 6.3s
2025-10-23 13:42:40 - INFO - EPOCH[23/100] loss0.150-|Sample:3.50| Time: 6.3s
2025-10-23 13:42:46 - INFO - EPOCH[24/100] loss0.147-|Sample:3.59| Time: 6.3s
2025-10-23 13:42:52 - INFO - EPOCH[25/100] loss0.143-|Sample:3.48| Time: 6.2s
2025-10-23 13:42:58 - INFO - EPOCH[26/100] loss0.139-|Sample:3.53| Time: 6.2s
2025-10-23 13:43:05 - INFO - EPOCH[27/100] loss0.136-|Sample:3.61| Time: 6.3s
2025-10-23 13:43:11 - INFO - EPOCH[28/100] loss0.134-|Sample:3.48| Time: 5.9s
2025-10-23 13:43:17 - INFO - EPOCH[29/100] loss0.130-|Sample:3.49| Time: 6.2s
2025-10-23 13:43:23 - INFO - EPOCH[30/100] loss0.126-|Sample:3.60| Time: 6.2s
2025-10-23 13:43:23 - INFO - 
[TEST] Epoch 30
2025-10-23 13:43:26 - INFO -   Recall@[20]: [0.07476319]
2025-10-23 13:43:26 - INFO -   Precision@[20]: [0.01371026]
2025-10-23 13:43:26 - INFO -   NDCG@[20]: [0.04372891]
2025-10-23 13:43:26 - INFO - ✓ New best! Recall@20: 0.0748
2025-10-23 13:43:32 - INFO - EPOCH[31/100] loss0.124-|Sample:3.60| Time: 8.8s
2025-10-23 13:43:38 - INFO - EPOCH[32/100] loss0.121-|Sample:3.36| Time: 6.0s
2025-10-23 13:43:44 - INFO - EPOCH[33/100] loss0.118-|Sample:3.58| Time: 6.3s
2025-10-23 13:43:51 - INFO - EPOCH[34/100] loss0.116-|Sample:3.76| Time: 6.6s
2025-10-23 13:43:57 - INFO - EPOCH[35/100] loss0.114-|Sample:3.48| Time: 5.6s
2025-10-23 13:44:02 - INFO - EPOCH[36/100] loss0.112-|Sample:3.63| Time: 5.6s
2025-10-23 13:44:08 - INFO - EPOCH[37/100] loss0.109-|Sample:3.47| Time: 5.8s
2025-10-23 13:44:15 - INFO - EPOCH[38/100] loss0.106-|Sample:3.57| Time: 6.2s
2025-10-23 13:44:21 - INFO - EPOCH[39/100] loss0.105-|Sample:3.60| Time: 6.1s
2025-10-23 13:44:27 - INFO - EPOCH[40/100] loss0.102-|Sample:3.51| Time: 6.2s
2025-10-23 13:44:27 - INFO - 
[TEST] Epoch 40
2025-10-23 13:44:29 - INFO -   Recall@[20]: [0.07850553]
2025-10-23 13:44:29 - INFO -   Precision@[20]: [0.01449302]
2025-10-23 13:44:29 - INFO -   NDCG@[20]: [0.04585005]
2025-10-23 13:44:29 - INFO - ✓ New best! Recall@20: 0.0785
2025-10-23 13:44:35 - INFO - EPOCH[41/100] loss0.101-|Sample:3.57| Time: 7.9s
2025-10-23 13:44:40 - INFO - EPOCH[42/100] loss0.098-|Sample:3.08| Time: 5.5s
2025-10-23 13:44:47 - INFO - EPOCH[43/100] loss0.097-|Sample:3.70| Time: 6.3s
2025-10-23 13:44:53 - INFO - EPOCH[44/100] loss0.095-|Sample:3.49| Time: 6.2s
2025-10-23 13:44:59 - INFO - EPOCH[45/100] loss0.092-|Sample:3.49| Time: 6.2s
2025-10-23 13:45:06 - INFO - EPOCH[46/100] loss0.092-|Sample:3.58| Time: 6.3s
2025-10-23 13:45:12 - INFO - EPOCH[47/100] loss0.091-|Sample:3.51| Time: 6.4s
2025-10-23 13:45:18 - INFO - EPOCH[48/100] loss0.089-|Sample:3.57| Time: 6.1s
2025-10-23 13:45:24 - INFO - EPOCH[49/100] loss0.087-|Sample:3.47| Time: 5.4s
2025-10-23 13:45:30 - INFO - EPOCH[50/100] loss0.085-|Sample:3.74| Time: 6.0s
2025-10-23 13:45:30 - INFO - 
[TEST] Epoch 50
2025-10-23 13:45:32 - INFO -   Recall@[20]: [0.08061225]
2025-10-23 13:45:32 - INFO -   Precision@[20]: [0.01496869]
2025-10-23 13:45:32 - INFO -   NDCG@[20]: [0.04703953]
2025-10-23 13:45:32 - INFO - ✓ New best! Recall@20: 0.0806
2025-10-23 13:45:38 - INFO - EPOCH[51/100] loss0.084-|Sample:3.41| Time: 7.9s
2025-10-23 13:45:43 - INFO - EPOCH[52/100] loss0.083-|Sample:3.08| Time: 5.2s
2025-10-23 13:45:49 - INFO - EPOCH[53/100] loss0.081-|Sample:3.58| Time: 6.3s
2025-10-23 13:45:55 - INFO - EPOCH[54/100] loss0.080-|Sample:3.47| Time: 6.2s
2025-10-23 13:46:02 - INFO - EPOCH[55/100] loss0.079-|Sample:3.58| Time: 6.3s
2025-10-23 13:46:08 - INFO - EPOCH[56/100] loss0.077-|Sample:3.58| Time: 6.1s
2025-10-23 13:46:14 - INFO - EPOCH[57/100] loss0.076-|Sample:3.46| Time: 6.2s
2025-10-23 13:46:21 - INFO - EPOCH[58/100] loss0.075-|Sample:3.60| Time: 6.3s
2025-10-23 13:46:27 - INFO - EPOCH[59/100] loss0.075-|Sample:3.48| Time: 6.0s
2025-10-23 13:46:32 - INFO - EPOCH[60/100] loss0.073-|Sample:3.48| Time: 5.5s
2025-10-23 13:46:32 - INFO - 
[TEST] Epoch 60
2025-10-23 13:46:35 - INFO -   Recall@[20]: [0.08256244]
2025-10-23 13:46:35 - INFO -   Precision@[20]: [0.01540523]
2025-10-23 13:46:35 - INFO -   NDCG@[20]: [0.0485022]
2025-10-23 13:46:35 - INFO - ✓ New best! Recall@20: 0.0826
2025-10-23 13:46:40 - INFO - EPOCH[61/100] loss0.072-|Sample:3.38| Time: 7.7s
2025-10-23 13:46:45 - INFO - EPOCH[62/100] loss0.071-|Sample:3.18| Time: 5.0s
2025-10-23 13:46:50 - INFO - EPOCH[63/100] loss0.069-|Sample:3.34| Time: 5.2s
2025-10-23 13:46:55 - INFO - EPOCH[64/100] loss0.069-|Sample:3.16| Time: 5.0s
2025-10-23 13:47:01 - INFO - EPOCH[65/100] loss0.068-|Sample:3.19| Time: 5.6s
2025-10-23 13:47:07 - INFO - EPOCH[66/100] loss0.067-|Sample:3.47| Time: 6.0s
2025-10-23 13:47:13 - INFO - EPOCH[67/100] loss0.066-|Sample:3.57| Time: 5.7s
2025-10-23 13:47:19 - INFO - EPOCH[68/100] loss0.066-|Sample:3.60| Time: 5.7s
2025-10-23 13:47:25 - INFO - EPOCH[69/100] loss0.065-|Sample:3.48| Time: 6.1s
2025-10-23 13:47:31 - INFO - EPOCH[70/100] loss0.064-|Sample:3.53| Time: 6.1s
2025-10-23 13:47:31 - INFO - 
[TEST] Epoch 70
2025-10-23 13:47:33 - INFO -   Recall@[20]: [0.08441426]
2025-10-23 13:47:33 - INFO -   Precision@[20]: [0.01563403]
2025-10-23 13:47:33 - INFO -   NDCG@[20]: [0.04911023]
2025-10-23 13:47:33 - INFO - ✓ New best! Recall@20: 0.0844
2025-10-23 13:47:40 - INFO - EPOCH[71/100] loss0.063-|Sample:3.56| Time: 8.8s
2025-10-23 13:47:46 - INFO - EPOCH[72/100] loss0.062-|Sample:3.52| Time: 5.9s
2025-10-23 13:47:52 - INFO - EPOCH[73/100] loss0.062-|Sample:3.60| Time: 6.2s
2025-10-23 13:47:58 - INFO - EPOCH[74/100] loss0.062-|Sample:3.69| Time: 6.3s
2025-10-23 13:48:05 - INFO - EPOCH[75/100] loss0.060-|Sample:3.68| Time: 6.3s
2025-10-23 13:48:11 - INFO - EPOCH[76/100] loss0.059-|Sample:3.61| Time: 6.3s
2025-10-23 13:48:18 - INFO - EPOCH[77/100] loss0.059-|Sample:3.74| Time: 6.4s
2025-10-23 13:48:24 - INFO - EPOCH[78/100] loss0.059-|Sample:3.66| Time: 6.5s
2025-10-23 13:48:31 - INFO - EPOCH[79/100] loss0.058-|Sample:3.73| Time: 6.4s
2025-10-23 13:48:37 - INFO - EPOCH[80/100] loss0.057-|Sample:3.68| Time: 6.4s
2025-10-23 13:48:37 - INFO - 
[TEST] Epoch 80
2025-10-23 13:48:39 - INFO -   Recall@[20]: [0.08484277]
2025-10-23 13:48:39 - INFO -   Precision@[20]: [0.01577854]
2025-10-23 13:48:39 - INFO -   NDCG@[20]: [0.04956706]
2025-10-23 13:48:39 - INFO - ✓ New best! Recall@20: 0.0848
2025-10-23 13:48:46 - INFO - EPOCH[81/100] loss0.057-|Sample:3.51| Time: 8.6s
2025-10-23 13:48:52 - INFO - EPOCH[82/100] loss0.056-|Sample:3.73| Time: 6.3s
2025-10-23 13:48:58 - INFO - EPOCH[83/100] loss0.055-|Sample:3.68| Time: 6.2s
2025-10-23 13:49:04 - INFO - EPOCH[84/100] loss0.055-|Sample:3.59| Time: 6.3s
2025-10-23 13:49:11 - INFO - EPOCH[85/100] loss0.055-|Sample:3.72| Time: 6.4s
2025-10-23 13:49:17 - INFO - EPOCH[86/100] loss0.053-|Sample:3.72| Time: 6.4s
2025-10-23 13:49:24 - INFO - EPOCH[87/100] loss0.053-|Sample:3.69| Time: 6.4s
2025-10-23 13:49:30 - INFO - EPOCH[88/100] loss0.052-|Sample:3.70| Time: 6.3s
2025-10-23 13:49:37 - INFO - EPOCH[89/100] loss0.052-|Sample:3.70| Time: 6.5s
2025-10-23 13:49:43 - INFO - EPOCH[90/100] loss0.052-|Sample:3.59| Time: 6.1s
2025-10-23 13:49:43 - INFO - 
[TEST] Epoch 90
2025-10-23 13:49:45 - INFO -   Recall@[20]: [0.08619444]
2025-10-23 13:49:45 - INFO -   Precision@[20]: [0.0159381]
2025-10-23 13:49:45 - INFO -   NDCG@[20]: [0.05056051]
2025-10-23 13:49:45 - INFO - ✓ New best! Recall@20: 0.0862
2025-10-23 13:49:52 - INFO - EPOCH[91/100] loss0.051-|Sample:3.56| Time: 8.6s
2025-10-23 13:49:58 - INFO - EPOCH[92/100] loss0.051-|Sample:3.70| Time: 6.1s
2025-10-23 13:50:04 - INFO - EPOCH[93/100] loss0.050-|Sample:3.61| Time: 6.2s
2025-10-23 13:50:10 - INFO - EPOCH[94/100] loss0.049-|Sample:3.74| Time: 6.4s
2025-10-23 13:50:17 - INFO - EPOCH[95/100] loss0.049-|Sample:3.68| Time: 6.3s
2025-10-23 13:50:23 - INFO - EPOCH[96/100] loss0.049-|Sample:3.75| Time: 5.9s
2025-10-23 13:50:29 - INFO - EPOCH[97/100] loss0.049-|Sample:3.56| Time: 5.9s
2025-10-23 13:50:35 - INFO - EPOCH[98/100] loss0.048-|Sample:3.84| Time: 6.4s
2025-10-23 13:50:41 - INFO - EPOCH[99/100] loss0.047-|Sample:3.72| Time: 6.3s
2025-10-23 13:50:48 - INFO - EPOCH[100/100] loss0.047-|Sample:3.69| Time: 6.4s
2025-10-23 13:50:48 - INFO - 
============================================================
2025-10-23 13:50:48 - INFO - Final Evaluation
2025-10-23 13:50:48 - INFO - ============================================================
2025-10-23 13:50:51 - INFO - 
Final Results:
2025-10-23 13:50:51 - INFO -   Recall@[20]: [0.08664921]
2025-10-23 13:50:51 - INFO -   Precision@[20]: [0.01608261]
2025-10-23 13:50:51 - INFO -   NDCG@[20]: [0.05079779]
2025-10-23 13:50:51 - INFO - 
Best: Epoch 90, Recall@20: 0.0862
2025-10-23 13:50:51 - INFO - 
✓ Training completed!
2025-10-23 13:50:51 - INFO - Log saved to: /home/chuc0007/reccase/LLM-GCN-Rec/src/training/../../logs/dualgraph_hybrid/train_dualgraph_hybrid_amazon-book_subset_10000_20251023_134005.log
